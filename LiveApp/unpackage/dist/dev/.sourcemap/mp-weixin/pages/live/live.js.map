{"version":3,"file":"live.js","sources":["pages/live/live.vue","E:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbGl2ZS9saXZlLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"live-container\">\n\t\t<view class=\"live-content\">\n\t\t\t<swiper \n\t\t\t\tclass=\"video-swiper\"\n\t\t\t\tvertical\n\t\t\t\tduration=\"300\"\n\t\t\t\tcircular\n\t\t\t\t@change=\"onSwiperChange\">\n\t\t\t\t<swiper-item v-for=\"(stream, index) in activeStreams\" :key=\"stream.id\">\n\t\t\t\t\t<view class=\"stream-item\">\n\t\t\t\t\t\t<video \n\t\t\t\t\t\t\t:id=\"'liveVideo' + index\" \n\t\t\t\t\t\t\t:src=\"'http://your-domain/live/' + stream.streamKey + '.m3u8'\"\n\t\t\t\t\t\t\tautoplay\n\t\t\t\t\t\t\tobject-fit=\"cover\"\n\t\t\t\t\t\t\t:show-fullscreen-btn=\"false\"\n\t\t\t\t\t\t\t:show-play-btn=\"false\"\n\t\t\t\t\t\t\t:show-center-play-btn=\"false\"\n\t\t\t\t\t\t\t:enable-progress-gesture=\"false\"\n\t\t\t\t\t\t\t:enable-play-gesture=\"false\"\n\t\t\t\t\t\t></video>\n\t\t\t\t\t\t<view class=\"stream-info\">\n\t\t\t\t\t\t\t<text class=\"stream-title\">{{ stream.title }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</swiper-item>\n\t\t\t\t\n\t\t\t\t<swiper-item v-if=\"activeStreams.length === 0\">\n\t\t\t\t\t<view class=\"no-stream\">\n\t\t\t\t\t\t<text class=\"no-stream-text\">No live stream</text>\n\t\t\t\t\t</view>\n\t\t\t\t</swiper-item>\n\t\t\t</swiper>\n\t\t</view>\n\t</view>\n</template>\n\n<script lang=\"ts\" setup>\n\timport { ref, onMounted, onUnmounted } from 'vue';\n\n\tconst activeStreams = ref([]);\n\tconst currentStreamIndex = ref(0);\n\n\n\tconst fetchActiveStreams = () => {\n\t\tuni.request({\n\t\t\turl: 'http://localhost:9001/api/live/active',\n\t\t\tmethod: 'GET',\n\t\t\tsuccess: (res) => {\n\t\t\t\tconst result = res.data as any;\n\t\t\t\tif (result.code === 0) {\n\t\t\t\t\tactiveStreams.value = result.data || [];\n\t\t\t\t}\n\t\t\t},\n\t\t\tfail: (err) => {\n\t\t\t\tuni.__f__('error','at pages/live/live.vue:57','Get live stream Fail:', err);\n\t\t\t}\n\t\t});\n\t};\n\n\tconst onSwiperChange = (e) => {\n\t\tcurrentStreamIndex.value = e.detail.current;\n\t};\n\n\tonMounted(() => {\n\t\tfetchActiveStreams();\n\t\t\n\t\tconst interval = setInterval(fetchActiveStreams, 10000);\n\t\t\n\t\t(onUnmounted as any).interval = interval;\n\t});\n\n\tonUnmounted(() => {\n\t\tif ((onUnmounted as any).interval) {\n\t\t\tclearInterval((onUnmounted as any).interval);\n\t\t}\n\t});\n</script>\n\n<style>\n\tpage {\n\t\theight: 100%;\n\t\toverflow: hidden;\n\t}\n\n\t.live-container {\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tbackground-color: #000000;\n\t}\n\n\t.live-content {\n\t\tposition: relative;\n\t\tflex: 1;\n\t\toverflow: hidden;\n\t}\n\n\t.video-swiper {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\n\t.stream-item {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tposition: relative;\n\t}\n\n\t.stream-item video {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tobject-fit: cover;\n\t\tdisplay: block;\n\t}\n\n\t.stream-info {\n\t\tposition: absolute;\n\t\tbottom: 200rpx;\n\t\tleft: 20rpx;\n\t\tright: 20rpx;\n\t\tbackground: rgba(0, 0, 0, 0.6);\n\t\tpadding: 20rpx;\n\t\tborder-radius: 10rpx;\n\t}\n\n\t.stream-title {\n\t\tcolor: #ffffff;\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t}\n\n\t.no-stream {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 100%;\n\t\tbackground-color: #000000;\n\t\twidth: 100%;\n\t}\n\n\t.no-stream-text {\n\t\tcolor: #ffffff;\n\t\tfont-size: 36rpx;\n\t}\n</style>","import MiniProgramPage from 'D:/javaproject/Live-streaming-platform/LiveApp/pages/live/live.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","onMounted","onUnmounted","MiniProgramPage"],"mappings":";;;;;AAyCO,UAAA,gBAAgBA,kBAAI,CAAA,CAAE;AACtB,UAAA,qBAAqBA,kBAAI,CAAC;AAGhC,UAAM,qBAAqB,MAAM;AAChCC,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,SAAS,CAAC,QAAQ;AACjB,gBAAM,SAAS,IAAI;AACf,cAAA,OAAO,SAAS,GAAG;AACR,0BAAA,QAAQ,OAAO,QAAQ,CAAA;AAAA,UACtC;AAAA,QACD;AAAA,QACA,MAAM,CAAC,QAAQ;AACdA,wBAAA,MAAI,MAAM,SAAQ,6BAA4B,yBAAyB,GAAG;AAAA,QAC3E;AAAA,MAAA,CACA;AAAA,IAAA;AAGI,UAAA,iBAAiB,CAAC,MAAM;AACV,yBAAA,QAAQ,EAAE,OAAO;AAAA,IAAA;AAGrCC,kBAAAA,UAAU,MAAM;AACI;AAEb,YAAA,WAAW,YAAY,oBAAoB,GAAK;AAErDC,gCAAoB,WAAW;AAAA,IAAA,CAChC;AAEDA,kBAAAA,YAAY,MAAM;AACjB,UAAKA,cAAAA,YAAoB,UAAU;AAClC,sBAAeA,cAAAA,YAAoB,QAAQ;AAAA,MAC5C;AAAA,IAAA,CACA;;;;;;;;;;;;;;;;;;AC5EF,GAAG,WAAWC,SAAe;"}